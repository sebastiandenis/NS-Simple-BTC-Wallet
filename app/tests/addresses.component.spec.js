"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("nativescript-angular/zone-js/testing.jasmine");
var testing_1 = require("nativescript-angular/testing");
var testing_2 = require("@angular/core/testing");
var btc_service_1 = require("~/services/btc.service");
var addresses_component_1 = require("~/home/addresses.component");
var rxjs_1 = require("rxjs");
testing_1.nsTestBedInit();
var FakeBtcService = /** @class */ (function () {
    function FakeBtcService() {
    }
    FakeBtcService.prototype.addAddress = function (a) { };
    FakeBtcService.prototype.getTotalAmount = function () {
        return rxjs_1.of();
    };
    FakeBtcService.prototype.getAddresses = function () {
        return rxjs_1.of();
    };
    FakeBtcService.prototype.removeAddress = function () { };
    return FakeBtcService;
}());
exports.FakeBtcService = FakeBtcService;
describe("AddressesComponent", function () {
    beforeEach(testing_1.nsTestBedBeforeEach([addresses_component_1.AddressesComponent], [{ provide: btc_service_1.BtcService, useValue: new FakeBtcService() }]));
    afterEach(testing_1.nsTestBedAfterEach(false));
    it("Component should exist", testing_2.async(function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            expect(componentRef).toBeDefined();
        });
    }));
    it("properties should be defined at component start", testing_2.async(function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            expect(componentRef.instance.addresses$).toBeDefined();
            expect(componentRef.instance.totalAmount$).toBeDefined();
            expect(componentRef.instance.newAddress).toEqual("");
        });
    }));
    it("BtcService.getAddress and getTotalAmount function should be called when ngOnInit() is called", function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            var service = componentRef.instance.btc;
            spyOn(service, "getAddresses");
            spyOn(service, "getTotalAmount");
            componentRef.instance.ngOnInit();
            expect(service.getAddresses).toHaveBeenCalled();
            expect(service.getTotalAmount).toHaveBeenCalled();
        });
    });
    it("property newAddress should be empty after onAdd() call", testing_2.async(function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            componentRef.instance.newAddress = "test";
            componentRef.instance.onAdd();
            expect(componentRef.instance.newAddress).toEqual("");
            componentRef.instance.newAddress = "";
            componentRef.instance.onAdd();
            expect(componentRef.instance.newAddress).toEqual("");
        });
    }));
    it("BtcService.addAddress() function should be called when onAdd() and newAddress is not empty", function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            var service = componentRef.instance.btc;
            spyOn(service, "addAddress");
            componentRef.instance.newAddress = "test";
            componentRef.instance.onAdd();
            expect(service.addAddress).toHaveBeenCalled();
            componentRef.instance.newAddress = "";
            componentRef.instance.onAdd();
            expect(service.addAddress).toHaveBeenCalledTimes(1);
        });
    });
    it("BtcService.removeAddress() should be called when onDel() was called", function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            var service = componentRef.instance.btc;
            spyOn(service, "removeAddress");
            componentRef.instance.onDel(null);
            expect(service.removeAddress).toHaveBeenCalled();
        });
    });
    it("getShortAddress should return short address", testing_2.async(function () {
        return testing_1.nsTestBedRender(addresses_component_1.AddressesComponent).then(function (fixture) {
            var componentRef = fixture.componentRef;
            componentRef.instance.newAddress =
                "12345678901234567890123456789012345678901234567890";
            var shortAddress = componentRef.instance.getShortAddress("1234567890-10-1234567890-20-1234567890-30-1234567890-40-1234567890-50");
            expect(shortAddress).toContain("...");
            shortAddress = componentRef.instance.getShortAddress("");
            expect(shortAddress).toContain("...");
        });
    }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkcmVzc2VzLmNvbXBvbmVudC5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYWRkcmVzc2VzLmNvbXBvbmVudC5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsd0RBQXNEO0FBQ3RELHdEQUtzQztBQUV0QyxpREFBOEM7QUFFOUMsc0RBQWdFO0FBQ2hFLGtFQUFnRTtBQUNoRSw2QkFBc0M7QUFFdEMsdUJBQWEsRUFBRSxDQUFDO0FBRWhCO0lBQUE7SUFXQSxDQUFDO0lBVkMsbUNBQVUsR0FBVixVQUFXLENBQVMsSUFBUyxDQUFDO0lBQzlCLHVDQUFjLEdBQWQ7UUFDRSxPQUFPLFNBQUUsRUFBRSxDQUFDO0lBQ2QsQ0FBQztJQUVELHFDQUFZLEdBQVo7UUFDRSxPQUFPLFNBQUUsRUFBRSxDQUFDO0lBQ2QsQ0FBQztJQUVELHNDQUFhLEdBQWIsY0FBdUIsQ0FBQztJQUMxQixxQkFBQztBQUFELENBQUMsQUFYRCxJQVdDO0FBWFksd0NBQWM7QUFhM0IsUUFBUSxDQUFDLG9CQUFvQixFQUFFO0lBQzdCLFVBQVUsQ0FDUiw2QkFBbUIsQ0FDakIsQ0FBQyx3Q0FBa0IsQ0FBQyxFQUNwQixDQUFDLEVBQUUsT0FBTyxFQUFFLHdCQUFVLEVBQUUsUUFBUSxFQUFFLElBQUksY0FBYyxFQUFFLEVBQUUsQ0FBQyxDQUMxRCxDQUNGLENBQUM7SUFFRixTQUFTLENBQUMsNEJBQWtCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUVyQyxFQUFFLENBQUMsd0JBQXdCLEVBQUUsZUFBSyxDQUFDO1FBQ2pDLE9BQU8seUJBQWUsQ0FBQyx3Q0FBa0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLE9BQU87WUFDckQsSUFBTSxZQUFZLEdBQ2hCLE9BQU8sQ0FBQyxZQUFZLENBQUM7WUFDdkIsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3JDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUMsQ0FB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LFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTixDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIm5hdGl2ZXNjcmlwdC1hbmd1bGFyL3pvbmUtanMvdGVzdGluZy5qYXNtaW5lXCI7XHJcbmltcG9ydCB7XHJcbiAgbnNUZXN0QmVkSW5pdCxcclxuICBuc1Rlc3RCZWRCZWZvcmVFYWNoLFxyXG4gIG5zVGVzdEJlZEFmdGVyRWFjaCxcclxuICBuc1Rlc3RCZWRSZW5kZXJcclxufSBmcm9tIFwibmF0aXZlc2NyaXB0LWFuZ3VsYXIvdGVzdGluZ1wiO1xyXG5cclxuaW1wb3J0IHsgYXN5bmMgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZS90ZXN0aW5nXCI7XHJcbmltcG9ydCB7IENvbXBvbmVudFJlZiB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEJ0Y1NlcnZpY2UsIEJ0Y0FkZHJlc3MgfSBmcm9tIFwifi9zZXJ2aWNlcy9idGMuc2VydmljZVwiO1xyXG5pbXBvcnQgeyBBZGRyZXNzZXNDb21wb25lbnQgfSBmcm9tIFwifi9ob21lL2FkZHJlc3Nlcy5jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgb2YsIE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xyXG5cclxubnNUZXN0QmVkSW5pdCgpO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZha2VCdGNTZXJ2aWNlIHtcclxuICBhZGRBZGRyZXNzKGE6IHN0cmluZyk6IHZvaWQge31cclxuICBnZXRUb3RhbEFtb3VudCgpOiBPYnNlcnZhYmxlPG51bWJlcj4ge1xyXG4gICAgcmV0dXJuIG9mKCk7XHJcbiAgfVxyXG5cclxuICBnZXRBZGRyZXNzZXMoKTogT2JzZXJ2YWJsZTxCdGNBZGRyZXNzW10+IHtcclxuICAgIHJldHVybiBvZigpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQWRkcmVzcygpOiB2b2lkIHt9XHJcbn1cclxuXHJcbmRlc2NyaWJlKFwiQWRkcmVzc2VzQ29tcG9uZW50XCIsICgpID0+IHtcclxuICBiZWZvcmVFYWNoKFxyXG4gICAgbnNUZXN0QmVkQmVmb3JlRWFjaChcclxuICAgICAgW0FkZHJlc3Nlc0NvbXBvbmVudF0sXHJcbiAgICAgIFt7IHByb3ZpZGU6IEJ0Y1NlcnZpY2UsIHVzZVZhbHVlOiBuZXcgRmFrZUJ0Y1NlcnZpY2UoKSB9XVxyXG4gICAgKVxyXG4gICk7XHJcblxyXG4gIGFmdGVyRWFjaChuc1Rlc3RCZWRBZnRlckVhY2goZmFsc2UpKTtcclxuXHJcbiAgaXQoXCJDb21wb25lbnQgc2hvdWxkIGV4aXN0XCIsIGFzeW5jKCgpID0+IHtcclxuICAgIHJldHVybiBuc1Rlc3RCZWRSZW5kZXIoQWRkcmVzc2VzQ29tcG9uZW50KS50aGVuKGZpeHR1cmUgPT4ge1xyXG4gICAgICBjb25zdCBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxBZGRyZXNzZXNDb21wb25lbnQ+ID1cclxuICAgICAgICBmaXh0dXJlLmNvbXBvbmVudFJlZjtcclxuICAgICAgZXhwZWN0KGNvbXBvbmVudFJlZikudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pKTtcclxuXHJcbiAgaXQoXCJwcm9wZXJ0aWVzIHNob3VsZCBiZSBkZWZpbmVkIGF0IGNvbXBvbmVudCBzdGFydFwiLCBhc3luYygoKSA9PiB7XHJcbiAgICByZXR1cm4gbnNUZXN0QmVkUmVuZGVyKEFkZHJlc3Nlc0NvbXBvbmVudCkudGhlbihmaXh0dXJlID0+IHtcclxuICAgICAgY29uc3QgY29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8QWRkcmVzc2VzQ29tcG9uZW50PiA9XHJcbiAgICAgICAgZml4dHVyZS5jb21wb25lbnRSZWY7XHJcbiAgICAgIGV4cGVjdChjb21wb25lbnRSZWYuaW5zdGFuY2UuYWRkcmVzc2VzJCkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGNvbXBvbmVudFJlZi5pbnN0YW5jZS50b3RhbEFtb3VudCQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChjb21wb25lbnRSZWYuaW5zdGFuY2UubmV3QWRkcmVzcykudG9FcXVhbChcIlwiKTtcclxuICAgIH0pO1xyXG4gIH0pKTtcclxuXHJcbiAgaXQoXCJCdGNTZXJ2aWNlLmdldEFkZHJlc3MgYW5kIGdldFRvdGFsQW1vdW50IGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBuZ09uSW5pdCgpIGlzIGNhbGxlZFwiLCAoKSA9PiB7XHJcbiAgICByZXR1cm4gbnNUZXN0QmVkUmVuZGVyKEFkZHJlc3Nlc0NvbXBvbmVudCkudGhlbihmaXh0dXJlID0+IHtcclxuICAgICAgY29uc3QgY29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8QWRkcmVzc2VzQ29tcG9uZW50PiA9XHJcbiAgICAgICAgZml4dHVyZS5jb21wb25lbnRSZWY7XHJcbiAgICAgIGNvbnN0IHNlcnZpY2U6IEJ0Y1NlcnZpY2UgPSBjb21wb25lbnRSZWYuaW5zdGFuY2UuYnRjO1xyXG4gICAgICBzcHlPbihzZXJ2aWNlLCBcImdldEFkZHJlc3Nlc1wiKTtcclxuICAgICAgc3B5T24oc2VydmljZSwgXCJnZXRUb3RhbEFtb3VudFwiKTtcclxuICAgICAgY29tcG9uZW50UmVmLmluc3RhbmNlLm5nT25Jbml0KCk7XHJcbiAgICAgIGV4cGVjdChzZXJ2aWNlLmdldEFkZHJlc3NlcykudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICBleHBlY3Qoc2VydmljZS5nZXRUb3RhbEFtb3VudCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG5cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdChcInByb3BlcnR5IG5ld0FkZHJlc3Mgc2hvdWxkIGJlIGVtcHR5IGFmdGVyIG9uQWRkKCkgY2FsbFwiLCBhc3luYygoKSA9PiB7XHJcbiAgICByZXR1cm4gbnNUZXN0QmVkUmVuZGVyKEFkZHJlc3Nlc0NvbXBvbmVudCkudGhlbihmaXh0dXJlID0+IHtcclxuICAgICAgY29uc3QgY29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8QWRkcmVzc2VzQ29tcG9uZW50PiA9XHJcbiAgICAgICAgZml4dHVyZS5jb21wb25lbnRSZWY7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5uZXdBZGRyZXNzID0gXCJ0ZXN0XCI7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5vbkFkZCgpO1xyXG4gICAgICBleHBlY3QoY29tcG9uZW50UmVmLmluc3RhbmNlLm5ld0FkZHJlc3MpLnRvRXF1YWwoXCJcIik7XHJcblxyXG4gICAgICBjb21wb25lbnRSZWYuaW5zdGFuY2UubmV3QWRkcmVzcyA9IFwiXCI7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5vbkFkZCgpO1xyXG5cclxuICAgICAgZXhwZWN0KGNvbXBvbmVudFJlZi5pbnN0YW5jZS5uZXdBZGRyZXNzKS50b0VxdWFsKFwiXCIpO1xyXG4gICAgfSk7XHJcbiAgfSkpO1xyXG5cclxuICBpdChcIkJ0Y1NlcnZpY2UuYWRkQWRkcmVzcygpIGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBvbkFkZCgpIGFuZCBuZXdBZGRyZXNzIGlzIG5vdCBlbXB0eVwiLCAoKSA9PiB7XHJcbiAgICByZXR1cm4gbnNUZXN0QmVkUmVuZGVyKEFkZHJlc3Nlc0NvbXBvbmVudCkudGhlbihmaXh0dXJlID0+IHtcclxuICAgICAgY29uc3QgY29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8QWRkcmVzc2VzQ29tcG9uZW50PiA9XHJcbiAgICAgICAgZml4dHVyZS5jb21wb25lbnRSZWY7XHJcbiAgICAgIGNvbnN0IHNlcnZpY2U6IEJ0Y1NlcnZpY2UgPSBjb21wb25lbnRSZWYuaW5zdGFuY2UuYnRjO1xyXG4gICAgICBzcHlPbihzZXJ2aWNlLCBcImFkZEFkZHJlc3NcIik7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5uZXdBZGRyZXNzID0gXCJ0ZXN0XCI7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5vbkFkZCgpO1xyXG4gICAgICBleHBlY3Qoc2VydmljZS5hZGRBZGRyZXNzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5uZXdBZGRyZXNzID0gXCJcIjtcclxuICAgICAgY29tcG9uZW50UmVmLmluc3RhbmNlLm9uQWRkKCk7XHJcbiAgICAgIGV4cGVjdChzZXJ2aWNlLmFkZEFkZHJlc3MpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdChcIkJ0Y1NlcnZpY2UucmVtb3ZlQWRkcmVzcygpIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBvbkRlbCgpIHdhcyBjYWxsZWRcIiwgKCkgPT4ge1xyXG4gICAgcmV0dXJuIG5zVGVzdEJlZFJlbmRlcihBZGRyZXNzZXNDb21wb25lbnQpLnRoZW4oZml4dHVyZSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPEFkZHJlc3Nlc0NvbXBvbmVudD4gPVxyXG4gICAgICAgIGZpeHR1cmUuY29tcG9uZW50UmVmO1xyXG4gICAgICBjb25zdCBzZXJ2aWNlOiBCdGNTZXJ2aWNlID0gY29tcG9uZW50UmVmLmluc3RhbmNlLmJ0YztcclxuICAgICAgc3B5T24oc2VydmljZSwgXCJyZW1vdmVBZGRyZXNzXCIpO1xyXG4gICAgICBjb21wb25lbnRSZWYuaW5zdGFuY2Uub25EZWwobnVsbCk7XHJcbiAgICAgIGV4cGVjdChzZXJ2aWNlLnJlbW92ZUFkZHJlc3MpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdChcImdldFNob3J0QWRkcmVzcyBzaG91bGQgcmV0dXJuIHNob3J0IGFkZHJlc3NcIiwgYXN5bmMoKCkgPT4ge1xyXG4gICAgcmV0dXJuIG5zVGVzdEJlZFJlbmRlcihBZGRyZXNzZXNDb21wb25lbnQpLnRoZW4oZml4dHVyZSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPEFkZHJlc3Nlc0NvbXBvbmVudD4gPVxyXG4gICAgICAgIGZpeHR1cmUuY29tcG9uZW50UmVmO1xyXG4gICAgICBjb21wb25lbnRSZWYuaW5zdGFuY2UubmV3QWRkcmVzcyA9XHJcbiAgICAgICAgXCIxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MFwiO1xyXG4gICAgICBsZXQgc2hvcnRBZGRyZXNzID0gY29tcG9uZW50UmVmLmluc3RhbmNlLmdldFNob3J0QWRkcmVzcyhcclxuICAgICAgICBcIjEyMzQ1Njc4OTAtMTAtMTIzNDU2Nzg5MC0yMC0xMjM0NTY3ODkwLTMwLTEyMzQ1Njc4OTAtNDAtMTIzNDU2Nzg5MC01MFwiXHJcbiAgICAgICk7XHJcbiAgICAgIGV4cGVjdChzaG9ydEFkZHJlc3MpLnRvQ29udGFpbihcIi4uLlwiKTtcclxuXHJcbiAgICAgIHNob3J0QWRkcmVzcyA9IGNvbXBvbmVudFJlZi5pbnN0YW5jZS5nZXRTaG9ydEFkZHJlc3MoXCJcIik7XHJcbiAgICAgIGV4cGVjdChzaG9ydEFkZHJlc3MpLnRvQ29udGFpbihcIi4uLlwiKTtcclxuICAgIH0pO1xyXG4gIH0pKTtcclxufSk7XHJcbiJdfQ==